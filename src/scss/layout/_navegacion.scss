@use 'base/variables' as v;
@use 'base/mixins' as m;

/** Estilos para la barra nav de index.html **/
.inicio {
    background-color: v.$dashboard;

    .barra {
        h2 {
            color: v.$blanco;
        }

        .enlaces {
            a {
                color: v.$blanco;

                &:hover {
                    text-decoration: underline;
                }
            }
        }
    }
}


/** Estilos generales para la barra nav **/
.barra {
    position: relative;
    display: flex;
    flex-direction: column;
    padding: 1rem 0;

    @include m.desktop {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
    }

    .busqueda {
        position: relative;
        background: #f5f5f5;
        border-radius: 2.5rem;
        padding: 1rem;
        width: 29rem;

        form {
            display: flex;
            align-items: center;
        }

        input {
            border: none;
            outline: 0;
            flex: 1;
            background: #f5f5f5;

            /* Normaliza la apariencia en todos los navegadores, especialmente en iOS */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            
            /* Asegura que el tamaño de la fuente sea al menos de 16px para evitar el zoom automático de iOS al enfocar */
            font-size: 1.6rem; 
            
            /* Asegura que el padding y el borde no alteren el ancho total del elemento */
            box-sizing: border-box; 
        }

        button {
            border: none;
            background: transparent;
            cursor: pointer;
            opacity: 0.7;
        }
    }

    .sugerencias {
        position: absolute;
        top: 100%; // Posiciona las sugerencias justo debajo del input
        left: 0;
        right: 0;
        background-color: #fff;
        border-radius: 5px;
        list-style: none;
        padding: 0;
        margin: 0;
        z-index: 1000;
        max-height: 200px; // Limita la altura máxima
        overflow-y: auto; // Permite desplazamiento si hay muchas sugerencias

        li {
            padding: 0.8rem;
            cursor: pointer;
            font-size: 1.4rem;

            &:hover {
                background-color: #f4f4f4;
            }
        }

        .sugerencia-header {
            font-weight: bold;
            padding: 0.8rem;
            background-color: #f9f9f9;
        }
    }

    .enlaces {
        display: flex;
        align-items: center;
        gap: 2rem;
        font-size: 2rem;

        &--inicio {
            @extend .enlaces;
            
            a {
                text-transform: uppercase;
            }
        }
        
        a {
            font-weight: v.$bold;
            color: v.$negro;
            position: relative;
        }

        .icono_favorito {
            height: 2.5rem;
        }

        .icono_perfil {
            height: 3.5rem;
            border-radius: 50%;
        }

        button {
            border: none;
            background: transparent;
            cursor: pointer;
            font-weight: v.$bold
        }
    }

}



/* Modal de Categorias */
.modal {
    opacity: 0;
    visibility: hidden;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    transition: opacity 0.3s ease, visibility 0.3s ease;

    .modal-content {
        background: #fff;
        padding: 2rem;
        border-radius: 8px;
        width: 30rem;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        position: relative;
    }

    ul {
        list-style: none;
        padding: 0;
    }

    li {
        padding: 10px 0;
    }

    a {
        text-decoration: none;
        color: #333;
        font-weight: 700;

        &:hover {
            color: #000;
        }
    }

    .close {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 3rem;
        cursor: pointer;
        background: transparent;
        border: none;
    }
}


.modal.show {
    opacity: 1;
    visibility: visible;
}

// Contenedor para el ícono en la barra de navegación del layout del comprador
.icono-badge-container {
    position: relative; // CREA EL CONTEXTO DE POSICIONAMIENTO
    display: inline-flex; // Permite que se comporte bien dentro del enlace
    align-items: center;
    justify-content: center;
}

// Badge de notificación
.message-badge,
.notification-badge,
.hamburger-badge {
    position: absolute;
    top: -5px;       
    right: -15px;    
    background-color: v.$rojo; 
    color: v.$blanco;
    border-radius: 50%;
    padding: 2px 6px;
    font-size: 1.2rem;
    font-weight: 700;
    min-width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    z-index: 10;
}



// ===== INICIO: CÓDIGO RESPONSIVE FINAL Y COMPLETO =====

// -- ESTILOS GLOBALES (AFECTAN A DESKTOP POR DEFECTO) --

// 1. Ocultar el texto de los enlaces en desktop
.link-text-mobile {
    display: none;
}

// 2. Ocultar la barra de búsqueda en desktop, ya que ahora está dentro de los enlaces
.barra .enlaces .busqueda {
    display: none;
}

// 3. Ocultar el menú hamburguesa en desktop
.mobile-menu {
    display: none;
    cursor: pointer;
    i {
        font-size: 3rem;
        color: v.$negro;
    }
    .header.inicio & {
        i {
            color: v.$blanco;
        }
    }
}

// -- ESTILOS RESPONSIVE (TABLET Y MÓVIL < 1200px) --
@media (max-width: (v.$desktop - 1px)) {

    // Ocultar la barra de búsqueda de escritorio en móvil
    .busqueda-desktop {
        display: none;
    }

    // Ocultar el ícono y mostrar el texto
    .icon-desktop {
        display: none !important; 
    }
    .link-text-mobile {
        display: inline;
    }

    .barra {
        flex-direction: row;
        justify-content: space-between; // Esto empuja los elementos a los extremos
        align-items: center;             // Esto los alinea verticalmente
    }

    .logo h2 {
        font-size: 2.2rem; 
        margin: 0;
    }
    .logo img {
        height: 4rem; // <-- Reduce este valor (antes era 5rem o más)
        width: auto;  // <-- Asegura que la proporción se mantenga
    }
    
    // Mostrar el ícono de hamburguesa
    .mobile-menu {
        display: block;
    }
    
    // Ocultar la navegación por defecto
    .barra .navegacion-principal {
        display: none; 
    }

    // Estilos para el menú desplegado (cuando se hace clic)
    .barra .navegacion-principal.mostrar {
        display: flex; 
        flex-direction: column;
        align-items: center;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background-color: v.$dashboard;
        padding: 2rem 0;
        z-index: 100;

        .header:not(.inicio) & {
             background-color: v.$blanco;
             border-top: 1px solid v.$gris-claro;
             box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header.inicio & {
            border-top: 1px solid rgba(v.$blanco, 0.2);
        }

        // Mostrar y estilizar la barra de búsqueda DENTRO del menú
        .busqueda-mobile {
            display: block;
            width: 90%;
            margin: 0 auto 2rem auto; // Mantiene el espaciado

            .sugerencias {
                display: none; // Nos aseguramos de que la lista no ocupe espacio
            }
        }
        
        // Estilos para los enlaces y botones
        a, button.categorias-btn {
            width: 100%;
            padding: 1.2rem 0;
            text-align: center;
            color: v.$blanco;
            font-size: 1.8rem;
            border: none;
            background: none;

            .header:not(.inicio) & {
                color: v.$negro;
            }
        }

        // Línea separadora (solo para los elementos intermedios, no el primero ni el último)
        > *:not(:first-child):not(:last-child) {
            border-bottom: 1px solid rgba(v.$blanco, 0.2);
            .header:not(.inicio) & {
            border-bottom: 1px solid v.$gris-claro;
            }
        }
    }
}
// ===== FIN: CÓDIGO RESPONSIVE FINAL Y COMPLETO =====


//=========================================
// ESTILOS PARA EL MENÚ DESPLEGABLE
//=========================================
.dropdown {
    position: relative;
    text-align: center;
    display: inline-block;

    &__boton {
        // Hereda estilos de los otros enlaces de la barra
        font-weight: v.$bold;
        font-size: 1.8rem;
        background: none;
        border: none;
        color: v.$negro;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center; // Centra el contenido del botón
        text-align: center;      // Centra el texto
        gap: .5rem;
        width: 100%;
        padding: 1.2rem 0;

        @include m.desktop {
            font-size: 2rem;
            padding: 0;
            width: auto; // En desktop, el ancho se ajusta al contenido
        }

        // Estilo para el header de la página de inicio (fondo oscuro)
        .inicio & {
            color: v.$blanco;
        }

        i {
            font-size: 1.4rem;
            transition: transform 0.3s ease;
        }
    }

    &__contenido {
        display: none; // Oculto por defecto
        position: absolute;
        background-color: v.$blanco;
        min-width: 220px; // Ancho mínimo
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1001; // Asegura que esté por encima de otros elementos
        border-radius: .8rem;
        overflow: hidden; // Para que los bordes redondeados se apliquen a los 'a'
        animation: fadeIn 0.3s ease-out;

        @media (max-width: (v.$desktop - 1px)) {
            width: 100%; // En móvil, ocupa todo el ancho
        }

        a {
            color: v.$gris-oscuro;
            padding: 1.2rem 1.6rem;
            text-decoration: none;
            display: block;
            font-size: 1.6rem; // Tamaño de fuente más estándar para menú
            font-weight: 400;
            cursor: pointer;

            &:hover {
                background-color: #f1f1f1;
            }
        }
    }

    // Clase para mostrar el contenido
    &.mostrar .dropdown__contenido {
        display: block;
    }

    // Rotar la flecha cuando el menú está abierto
    &.mostrar .dropdown__boton i {
        transform: rotate(180deg);
    }

    // ===== Border bottom en móvil como los otros elementos =====
    @media (max-width: (v.$desktop - 1px)) {
        width: 100%;
    }
}

@media (max-width: (v.$desktop - 1px)) {
    .dropdown {
        width: 100%;

        &__contenido {
            width: 100%;
        }
    }
}

// Keyframe para la animación
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}